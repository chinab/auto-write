<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">

<sqlMap namespace="MEMO">
	<statement id="site.private.list.count" parameterClass="java.util.HashMap" resultClass="java.lang.Long">
		select count(1) from (
			select @RNUM:=0, Q.* from (
				select
					SEQ_ID, MASTER_SEQ_ID, DOMAIN, SITE_NAME, WRITER_SEQ_ID, WRITER_ID, WRITE_DATETIME
				from
					SITE_PRIVATE
				where
					WRITER_SEQ_ID = #USER_SEQ_ID#
				order by
					WRITE_DATETIME desc
			) Q
			where
				1=1
				<isNotNull prepend="and" removeFirstPrepend="true" property="SEARCH_VALUE">
						$SEARCH_KEY$ like concat('%', #SEARCH_VALUE#, '%')
				</isNotNull>
		) R
	</statement>
	
	
	<statement id="site.private.list" parameterClass="java.util.HashMap" resultClass="com.autowrite.common.framework.entity.BoardEntity">
		select @RNUM:=0, Q.* from (
			select
				SEQ_ID, MASTER_SEQ_ID, DOMAIN, SITE_NAME, WRITER_SEQ_ID, WRITER_ID, WRITE_DATETIME
			from
				SITE_PRIVATE
			where
				WRITER_SEQ_ID = #USER_SEQ_ID#
			order by
				WRITE_DATETIME desc
		) Q
		where
			1=1
			<isNotNull prepend="and" removeFirstPrepend="true" property="SEARCH_VALUE">
					$SEARCH_KEY$ like concat('%', #SEARCH_VALUE#, '%')
			</isNotNull>
	</statement>
	
	
	<statement id="site.master.list.count" parameterClass="java.util.HashMap" resultClass="java.lang.Long">
		select count(1) from (
			select @RNUM:=0, Q.* from (
				select
					SEQ_ID, DOMAIN, SITE_NAME, WRITE_URL, MODIFY_URL, DELETE_URL, WRITER_SEQ_ID, WRITER_ID, WRITE_DATETIME
				from
					SITE_MASTER
				where
					WRITER_SEQ_ID = #USER_SEQ_ID#
				order by
					WRITE_DATETIME desc
			) Q
			where
				1=1
				<isNotNull prepend="and" removeFirstPrepend="true" property="SEARCH_VALUE">
						$SEARCH_KEY$ like concat('%', #SEARCH_VALUE#, '%')
				</isNotNull>
		) R
	</statement>
	
	
	<statement id="site.master.list" parameterClass="java.util.HashMap" resultClass="com.autowrite.common.framework.entity.BoardEntity">
		select @RNUM:=0, Q.* from (
			select
				SEQ_ID, DOMAIN, SITE_NAME, WRITE_URL, MODIFY_URL, DELETE_URL, WRITER_SEQ_ID, WRITER_ID, WRITE_DATETIME
			from
				SITE_MASTER
			where
				WRITER_SEQ_ID = #USER_SEQ_ID#
			order by
				WRITE_DATETIME desc
		) Q
		where
			1=1
			<isNotNull prepend="and" removeFirstPrepend="true" property="SEARCH_VALUE">
					$SEARCH_KEY$ like concat('%', #SEARCH_VALUE#, '%')
			</isNotNull>
	</statement>
	
	<statement id="site.private.write" parameterClass="java.util.HashMap">
		insert into SITE_PRIVATE (
			MASTER_SEQ_ID, DOMAIN, SITE_NAME, SITE_ID, SITE_PASSWD, WRITER_SEQ_ID, WRITER_ID, WRITE_DATETIME 
		) values (
			#MASTER_SEQ_ID#, #DOMAIN#, #SITE_NAME#, #WRITER_SEQ_ID#, #WRITER_ID#, sysdate()
		)
	</statement>
	
	
	<statement id="contents.private.list.count" parameterClass="java.util.HashMap" resultClass="java.lang.Long">
		select count(1) from (
			select @RNUM:=0, Q.* from (
				select
					*
				from
					CONTENTS_MASTER
				where
					WRITER_SEQ_ID = #USER_SEQ_ID#
				order by
					WRITE_DATETIME desc
			) Q
			where
				1=1
				<isNotNull prepend="and" removeFirstPrepend="true" property="SEARCH_VALUE">
						$SEARCH_KEY$ like concat('%', #SEARCH_VALUE#, '%')
				</isNotNull>
		) R
	</statement>
	
	
	<statement id="contents.private.list" parameterClass="java.util.HashMap" resultClass="com.autowrite.common.framework.entity.BoardEntity">
		select @RNUM:=0, Q.* from (
			select
				SEQ_ID, CONTENTS_NAME, TITLE, CONTENT, WRITER_SEQ_ID, WRITER_ID, WRITE_DATETIME
			from
				CONTENTS_MASTER
			where
				WRITER_SEQ_ID = #USER_SEQ_ID#
			order by
				WRITE_DATETIME desc
		) Q
		where
			1=1
			<isNotNull prepend="and" removeFirstPrepend="true" property="SEARCH_VALUE">
					$SEARCH_KEY$ like concat('%', #SEARCH_VALUE#, '%')
			</isNotNull>
	</statement>
	
	
	<statement id="contents.private.write" parameterClass="java.util.HashMap">
		insert into CONTENTS_MASTER (
			CONTENTS_NAME, TITLE, CONTENT, WRITER_SEQ_ID, WRITER_ID, WRITE_DATETIME 
		) values (
			#CONTENTS_NAME#, #TITLE#, #CONTENT#, #WRITER_SEQ_ID#, #WRITER_ID#, sysdate()
		)
	</statement>
	
	
	<statement id="contents.private.select" parameterClass="java.util.HashMap" resultClass="com.autowrite.common.framework.entity.BoardEntity">
		select
			SEQ_ID, CONTENTS_NAME, TITLE, CONTENT, WRITER_SEQ_ID, WRITER_ID, WRITE_DATETIME
		from
			CONTENTS_MASTER
		where
			SEQ_ID = #SEQ_ID#
	</statement>
	
	
	<insert id="autowrite.master.write" parameterClass="java.util.HashMap" >
	    <![CDATA[
	        insert into $TABLE_NAME$ (
				USER_SEQ_ID, USER_ID, TITLE, FACILITY_NAME, FACILITY_USER_NAME, FACILITY_PHONE, FACILITY_ADDRESS, FACILITY_HOME_PAGE, VISIT_TIME, WAITERESS_NAME, CONTENT, CATEGORY, TARGET_CATEGORY, REGION, HIT, RECOMMEND, REJECT, SECRET_YN, BLIND_YN, DEL_YN, WRITER_IP, WRITE_DATETIME
			) values (
				#USER_SEQ_ID#, #USER_ID#, #TITLE#, #FACILITY_NAME#, #FACILITY_USER_NAME#, #FACILITY_PHONE#, #FACILITY_ADDRESS#, #FACILITY_HOME_PAGE#, #VISIT_TIME#, #WAITERESS_NAME#, #CONTENT#, #CATEGORY#, #TARGET_CATEGORY#, #REGION#, #HIT#, #RECOMMEND#, #REJECT#, #SECRET_YN#, #BLIND_YN#, #DEL_YN#, #WRITER_IP#, sysdate()
			)
	    ]]>
	    <selectKey keyProperty="seqId" resultClass="Long">
	        SELECT LAST_INSERT_ID()
	    </selectKey>
	</insert>
	
</sqlMap>